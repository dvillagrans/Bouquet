(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[571],{4922:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>_});var a=t(5155),s=t(2115),n=t(63),i=t(2467),o=t(3101),l=t(2821),d=t(5889);function c(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,d.QP)((0,l.$)(r))}let u=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md hover:shadow-lg",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border-2 border-primary bg-transparent text-primary hover:bg-primary hover:text-primary-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-md hover:shadow-lg",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",elegant:"bg-buccaneer-700 text-white hover:bg-buccaneer-600 shadow-lg hover:shadow-xl font-elegant"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-12 rounded-lg px-8 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),m=s.forwardRef((e,r)=>{let{className:t,variant:s,size:n,asChild:o=!1,...l}=e,d=o?i.DX:"button";return(0,a.jsx)(d,{className:c(u({variant:s,size:n,className:t})),ref:r,...l})});m.displayName="Button";let f=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:c("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});f.displayName="Card";let g=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:c("flex flex-col space-y-1.5 p-6",t),...s})});g.displayName="CardHeader";let p=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("h3",{ref:r,className:c("text-2xl font-semibold leading-none tracking-tight",t),...s})});p.displayName="CardTitle",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("p",{ref:r,className:c("text-sm text-muted-foreground",t),...s})}).displayName="CardDescription";let x=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:c("p-6 pt-0",t),...s})});x.displayName="CardContent",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:c("flex items-center p-6 pt-0",t),...s})}).displayName="CardFooter";let h=s.forwardRef((e,r)=>{let{className:t,type:s,...n}=e;return(0,a.jsx)("input",{type:s,className:c("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n})});h.displayName="Input";var b=t(489);let v=(0,o.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),y=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(b.b,{ref:r,className:c(v(),t),...s})});y.displayName=b.b.displayName;var N=t(9966),w=t(8720),j=t(5959),k=t(9863);let C=(0,j.v)()((0,k.Zr)((e,r)=>({session:null,setSession:r=>e({session:r}),guestId:null,guestName:null,setGuest:(r,t)=>e({guestId:r,guestName:t}),cart:[],addToCart:t=>{let a=r().cart;a.find(e=>e.id===t.id)?e({cart:a.map(e=>e.id===t.id?{...e,quantity:e.quantity+1}:e)}):e({cart:[...a,{...t,quantity:1}]})},removeFromCart:t=>{e({cart:r().cart.filter(e=>e.id!==t)})},updateQuantity:(t,a)=>{if(a<=0)return void r().removeFromCart(t);e({cart:r().cart.map(e=>e.id===t?{...e,quantity:a}:e)})},clearCart:()=>e({cart:[]}),getTotalPrice:()=>r().cart.reduce((e,r)=>e+r.price*r.quantity,0),assignments:{},setAssignments:r=>e({assignments:r}),reset:()=>e({session:null,guestId:null,guestName:null,cart:[],assignments:{}})}),{name:"bouquet-storage",partialize:e=>({session:e.session,guestId:e.guestId,guestName:e.guestName,cart:e.cart})}));function _(){let e=(0,n.useParams)(),r=(0,n.useRouter)(),t=e.code,[i,o]=(0,s.useState)(!0),[l,d]=(0,s.useState)(null),[c,u]=(0,s.useState)(""),[b,v]=(0,s.useState)(!1),{setSession:j,setGuest:k}=C();(0,s.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/api/sessions?code=".concat(t.toUpperCase()));if(!e.ok){w.toast.error("Sesi\xf3n no encontrada"),r.push("/");return}let a=await e.json();d(a)}catch(e){console.error("Error fetching session:",e),w.toast.error("Error al cargar la sesi\xf3n"),r.push("/")}finally{o(!1)}};t&&e()},[t,r]);let _=async()=>{if(!c.trim())return void w.toast.error("Por favor ingresa tu nombre");if(l){v(!0);try{let e="guest-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(7));j(l),k(e,c.trim()),w.toast.success("\xa1Bienvenido ".concat(c,"!")),r.push("/summary/".concat(l.id))}catch(e){console.error("Error joining session:",e),w.toast.error("Error al unirse a la sesi\xf3n")}finally{v(!1)}}};return i?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-albescent-white-50 via-pink-50 to-coral-tree-50 flex items-center justify-center",children:(0,a.jsx)(N.A,{className:"h-8 w-8 animate-spin text-coral-tree-500"})}):l?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-albescent-white-50 via-pink-50 to-coral-tree-50 flex items-center justify-center p-6",children:(0,a.jsxs)(f,{className:"glass-card border-0 p-8 max-w-md w-full",children:[(0,a.jsxs)(g,{children:[(0,a.jsx)(p,{className:"text-4xl font-script text-center text-buccaneer-700 mb-2",children:"\xa1Bienvenido!"}),(0,a.jsx)("p",{className:"text-center text-lg text-buccaneer-600",children:l.restaurant_name}),(0,a.jsxs)("p",{className:"text-center text-sm text-buccaneer-500",children:["Mesa: ",l.code]})]}),(0,a.jsxs)(x,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(y,{htmlFor:"guestName",className:"text-buccaneer-700",children:"Tu nombre"}),(0,a.jsx)(h,{id:"guestName",type:"text",placeholder:"Ej: Juan P\xe9rez",value:c,onChange:e=>u(e.target.value),onKeyPress:e=>"Enter"===e.key&&_(),className:"glass-light border-0"})]}),(0,a.jsx)(m,{onClick:_,disabled:b||!c.trim(),className:"w-full bg-gradient-to-r from-coral-tree-500 to-pink-500 hover:from-coral-tree-600 hover:to-pink-600 text-white",size:"lg",children:b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Uni\xe9ndose..."]}):"Unirse a la mesa"}),(0,a.jsx)("div",{className:"text-center text-sm text-buccaneer-500",children:(0,a.jsxs)("p",{children:["IVA: ",l.tax_rate,"% â€¢ Propina: ",l.tip_rate,"%"]})})]})]})}):null}},6990:(e,r,t)=>{Promise.resolve().then(t.bind(t,4922))}},e=>{e.O(0,[241,807,441,255,358],()=>e(e.s=6990)),_N_E=e.O()}]);